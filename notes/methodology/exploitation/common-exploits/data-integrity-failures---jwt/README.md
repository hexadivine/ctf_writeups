
![](assets/Pasted%20image%2020241128131859.png)
# Introduction

Let's think of how web applications maintain sessions. Usually, when a user logs into an application, they will be assigned some sort of session token that will need to be saved on the browser for as long as the session lasts. This token will be repeated on each subsequent request so that the web application knows who we are. These session tokens can come in many forms but are usually assigned via cookies. **Cookies** are key-value pairs that a web application will store on the user's browser and that will be automatically repeated on each request to the website that issued them.

**JWTs** are very simple tokens that allow you to store key-value pairs on a token that provides integrity as part of the token. The idea is that you can generate tokens that you can give your users with the certainty that they won't be able to alter the key-value pairs and pass the integrity check. The structure of a JWT token is formed of 3 parts:

![](assets/Pasted%20image%2020241128132102.png)

Notice that each of the 3 parts of the token is simply plaintext encoded with base64. You can use [this online tool](https://appdevtools.com/base64-encoder-decoder) to encode/decode base64. Try decoding the header and payload of the following token:

```
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Imd1ZXN0IiwiZXhwIjoxNjY1MDc2ODM2fQ.C8Z3gJ7wPgVLvEUonaieJWBJBYt5xOph2CpIhlxqdUw
```

```
┌─[lnxuser@redzone]─[/tmp]
└──╼ $echo eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9 | base64 -d
{"typ":"JWT","alg":"HS256"}
```

```
┌─[lnxuser@redzone]─[/tmp]
└──╼ $echo eyJ1c2VybmFtZSI6Imd1ZXN0IiwiZXhwIjoxNjY1MDc2ODM2fQ | base64 -d
{"username":"guest","exp":1665076836}
```

```
C8Z3gJ7wPgVLvEUonaieJWBJBYt5xOph2CpIhlxqdUw - this string is hash of above 2.
```

Taking the JWT from before as an example, if we wanted to change the payload so that the username becomes "admin" and no signature check is done, we would have to decode the header and payload, modify them as needed, and encode them back. **Notice how we removed the signature part but kept the dot at the end**

1. Modify the header section of the token so that the `alg` header would contain the value `none`.
2. Remove the signature part.

![](assets/Pasted%20image%2020241128132533.png)

Creating malicious JWT for admin

![](assets/Pasted%20image%2020241128132730.png)
![](assets/Pasted%20image%2020241128132836.png)

We get below JWT.

```
eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjY1MDc2ODM2fQ.
```

Inserting this cookie in `jwt-session` grants admin access.

![](assets/Pasted%20image%2020241128133413.png)